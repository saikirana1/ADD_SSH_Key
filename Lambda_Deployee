FROM public.ecr.aws/lambda/python:3.12

WORKDIR /var/task

# Copy only requirements first (better caching)
COPY requirements.txt .

# Install dependencies into Lambda system Python
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of the code
COPY . .

# Lambda handler
CMD ["main.handler"]



Docker_commends

sudo docker buildx build --no-cache --platform linux/amd64 -t lambda-elephant --load .
sudo docker tag lambda-elephant:latest 333600347554.dkr.ecr.ap-south-1.amazonaws.com/lambda-elephant:latest
sudo docker push 333600347554.dkr.ecr.ap-south-1.amazonaws.com/lambda-elephant:latest

uv export --format requirements-txt --output-file requirements.txt




from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from mangum import Mangum
from src.api import register_routes

app = FastAPI()

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

@app.get("/demo")
def read_root():
    return {"message": "Hello, FastAPI for nahla project"}

register_routes(app)

# REQUIRED for Lambda
handler = Mangum(app)
